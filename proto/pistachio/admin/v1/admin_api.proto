syntax = "proto3";

package pistachio.admin.v1;

import "pistachio/admin/v1/api_key.proto";
import "pistachio/admin/v1/app.proto";
import "pistachio/admin/v1/auth_provider.proto";
import "pistachio/admin/v1/mfa.proto";
import "pistachio/admin/v1/project.proto";
import "pistachio/admin/v1/service_account.proto";
import "pistachio/admin/v1/tenant.proto";
import "pistachio/admin/v1/token.proto";
import "pistachio/admin/v1/usage.proto";
import "pistachio/admin/v1/user.proto";

// =============================================================================
// Pistachio Admin Service
// =============================================================================
// PistachioAdmin provides administrative operations for managing Pistachio projects and tenants.
// Requires service account authentication.
service PistachioAdmin {
  // CreateProject creates a new Pistachio project.
  //
  // Projects are the top-level container for apps, users, and resources.
  // Each project can have multiple apps across different platforms
  // that share the same user pool.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id format or display_name
  // - ALREADY_EXISTS: Project ID is already taken
  // - PERMISSION_DENIED: Insufficient permissions
  rpc CreateProject(CreateProjectRequest) returns (CreateProjectResponse);

  // GetProject retrieves a project by its ID.
  //
  // Returns the project details including its current state and resources.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetProject(GetProjectRequest) returns (GetProjectResponse);

  // UpdateProject updates an existing project.
  //
  // Currently only the display_name can be updated.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or display_name format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UpdateProject(UpdateProjectRequest) returns (UpdateProjectResponse);

  // DeleteProject soft-deletes a project.
  //
  // The project will be marked as DELETED and will be permanently removed
  // after 30 days. During this period, the project can be restored.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteProject(DeleteProjectRequest) returns (DeleteProjectResponse);

  // UndeleteProject restores a soft-deleted project.
  //
  // The project must be in the DELETED state and within the 30-day
  // grace period. The project will be restored to ACTIVE state.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id format
  // - NOT_FOUND: Project does not exist
  // - FAILED_PRECONDITION: Project is not in DELETED state
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UndeleteProject(UndeleteProjectRequest) returns (UndeleteProjectResponse);

  // ListProjects lists all projects accessible to the service account.
  //
  // Results are paginated and can optionally include deleted projects.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid page_size or page_token
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListProjects(ListProjectsRequest) returns (ListProjectsResponse);

  // SearchProjects searches for projects using full-text search.
  //
  // Provides advanced search capabilities including:
  // - Full-text search across project fields
  // - Field-specific queries (e.g., display_name:Production*)
  // - Boolean operators (AND, OR, NOT)
  // - Range queries for dates
  // - Flexible sorting and cursor-based pagination
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid search query or parameters
  // - PERMISSION_DENIED: Insufficient permissions
  rpc SearchProjects(SearchProjectsRequest) returns (SearchProjectsResponse);

  // GetAdminSdkConfig retrieves the Admin SDK configuration for a project.
  //
  // Returns configuration needed to initialize the Admin SDK, including
  // storage bucket URL and database URL.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetAdminSdkConfig(GetAdminSdkConfigRequest) returns (GetAdminSdkConfigResponse);

  // =============================================================================
  // Tenant Operations
  // =============================================================================

  // CreateTenant creates a new tenant within a project.
  //
  // Tenants provide multi-tenant isolation within a project, allowing
  // each tenant to have its own user pool and authentication configuration.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, or display_name format
  // - ALREADY_EXISTS: Tenant ID is already taken within this project
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc CreateTenant(CreateTenantRequest) returns (CreateTenantResponse);

  // GetTenant retrieves a tenant by its ID.
  //
  // Returns the tenant details including its authentication configuration.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or tenant_id format
  // - NOT_FOUND: Project or tenant does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetTenant(GetTenantRequest) returns (GetTenantResponse);

  // UpdateTenant updates an existing tenant.
  //
  // Updates the tenant's display name, authentication settings, or MFA configuration.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, or field format
  // - NOT_FOUND: Project or tenant does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UpdateTenant(UpdateTenantRequest) returns (UpdateTenantResponse);

  // DeleteTenant permanently deletes a tenant.
  //
  // This operation is irreversible. All users and data associated with
  // the tenant will be permanently deleted.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or tenant_id format
  // - NOT_FOUND: Project or tenant does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteTenant(DeleteTenantRequest) returns (DeleteTenantResponse);

  // ListTenants lists all tenants within a project.
  //
  // Results are paginated and sorted by creation time by default.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, page_size, or page_token
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListTenants(ListTenantsRequest) returns (ListTenantsResponse);

  // SearchTenants searches for tenants within a project using full-text search.
  //
  // Provides advanced search capabilities including:
  // - Full-text search across tenant fields
  // - Field-specific queries (e.g., display_name:Production*)
  // - Boolean operators (AND, OR, NOT)
  // - Range queries for dates
  // - Flexible sorting and cursor-based pagination
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or search query
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc SearchTenants(SearchTenantsRequest) returns (SearchTenantsResponse);

  // =============================================================================
  // Project Auth Provider Operations
  // =============================================================================

  // ListProjectAuthProviders lists all auth providers configured for a project.
  //
  // Returns all configured auth providers with their settings, ordered by
  // display_order.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListProjectAuthProviders(ListProjectAuthProvidersRequest) returns (ListProjectAuthProvidersResponse);

  // GetProjectAuthProvider retrieves a specific auth provider for a project.
  //
  // Returns the provider configuration including enabled state and settings.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or provider_id format
  // - NOT_FOUND: Project or provider does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetProjectAuthProvider(GetProjectAuthProviderRequest) returns (GetProjectAuthProviderResponse);

  // UpdateProjectAuthProvider creates or updates an auth provider for a project.
  //
  // This is an upsert operation: if the provider exists, it is updated;
  // otherwise, a new provider is created. Supports providers:
  // - pdpka: Passphrase-derived public key authentication
  // - anonymous: Anonymous/guest authentication
  // - google, apple, facebook, github: OAuth 2.0 social providers
  // - oidc:<name>: Generic OpenID Connect providers
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, provider_id, or config format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UpdateProjectAuthProvider(UpdateProjectAuthProviderRequest) returns (UpdateProjectAuthProviderResponse);

  // DeleteProjectAuthProvider permanently removes an auth provider from a project.
  //
  // Deleting a provider will prevent users from authenticating with that
  // method. Existing users who only have this auth method will be locked out.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or provider_id format
  // - NOT_FOUND: Project or provider does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteProjectAuthProvider(DeleteProjectAuthProviderRequest) returns (DeleteProjectAuthProviderResponse);

  // =============================================================================
  // Tenant Auth Provider Override Operations
  // =============================================================================

  // ListTenantAuthProviders lists tenant-level auth provider overrides.
  //
  // Returns only the overrides explicitly set for this tenant, not the
  // full effective configuration. Use GetEffectiveTenantAuthProviders
  // for the merged configuration.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or tenant_id format
  // - NOT_FOUND: Project or tenant does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListTenantAuthProviders(ListTenantAuthProvidersRequest) returns (ListTenantAuthProvidersResponse);

  // UpdateTenantAuthProvider creates or updates a tenant-level auth provider override.
  //
  // Tenant overrides allow customizing auth provider settings per tenant.
  // Fields not set inherit from the project-level configuration.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, or provider_id format
  // - NOT_FOUND: Project, tenant, or project-level provider does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UpdateTenantAuthProvider(UpdateTenantAuthProviderRequest) returns (UpdateTenantAuthProviderResponse);

  // DeleteTenantAuthProvider removes a tenant-level auth provider override.
  //
  // After deletion, the tenant will inherit the project-level configuration
  // for this provider.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, or provider_id format
  // - NOT_FOUND: Project, tenant, or override does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteTenantAuthProvider(DeleteTenantAuthProviderRequest) returns (DeleteTenantAuthProviderResponse);

  // GetEffectiveTenantAuthProviders retrieves the merged auth provider configuration.
  //
  // Returns the effective configuration for a tenant after applying
  // tenant-level overrides to project-level configuration. Each provider
  // includes a source indicator showing where the configuration originates.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or tenant_id format
  // - NOT_FOUND: Project or tenant does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetEffectiveTenantAuthProviders(GetEffectiveTenantAuthProvidersRequest) returns (GetEffectiveTenantAuthProvidersResponse);

  // =============================================================================
  // App Operations
  // =============================================================================

  // CreateApp registers a new app in the project.
  //
  // API keys are auto-generated for each app.
  // Platform-specific configuration is provided via the oneof platform_config field.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or platform config
  // - NOT_FOUND: Project does not exist
  // - ALREADY_EXISTS: App with same identifier exists in project
  // - PERMISSION_DENIED: Insufficient permissions
  rpc CreateApp(CreateAppRequest) returns (CreateAppResponse);

  // GetApp retrieves an app by ID.
  //
  // Errors:
  // - NOT_FOUND: App does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetApp(GetAppRequest) returns (GetAppResponse);

  // ListApps lists apps in a project.
  //
  // Results are paginated and sorted by creation time by default.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, page_size, or page_token
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListApps(ListAppsRequest) returns (ListAppsResponse);

  // SearchApps searches for apps within a project using full-text search.
  //
  // Provides advanced search capabilities including:
  // - Full-text search across app fields
  // - Field-specific queries (e.g., display_name:Production*, platform:IOS)
  // - Boolean operators (AND, OR, NOT)
  // - Range queries for dates
  // - Flexible sorting and cursor-based pagination
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or search query
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc SearchApps(SearchAppsRequest) returns (SearchAppsResponse);

  // UpdateApp updates an app's mutable fields.
  //
  // Platform-specific fields can be updated via the oneof platform_config field.
  //
  // Errors:
  // - NOT_FOUND: App does not exist
  // - INVALID_ARGUMENT: Invalid update parameters
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UpdateApp(UpdateAppRequest) returns (UpdateAppResponse);

  // DeleteApp schedules an app for deletion (soft delete).
  //
  // The app enters DELETED state and will be permanently removed after 30 days.
  //
  // Errors:
  // - NOT_FOUND: App does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteApp(DeleteAppRequest) returns (DeleteAppResponse);

  // UndeleteApp restores a soft-deleted app.
  //
  // Only works for apps in DELETED state.
  //
  // Errors:
  // - NOT_FOUND: App does not exist
  // - FAILED_PRECONDITION: App is not in DELETED state
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UndeleteApp(UndeleteAppRequest) returns (UndeleteAppResponse);

  // GetAppConfig retrieves the SDK configuration for an app.
  //
  // Returns platform-specific configuration files:
  // - iOS: GoogleService-Info.plist
  // - Android: google-services.json
  // - macOS/Windows/Linux: pistachio-config.json
  // - Web: JavaScript config object
  //
  // Errors:
  // - NOT_FOUND: App does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetAppConfig(GetAppConfigRequest) returns (GetAppConfigResponse);

  // =============================================================================
  // Project User Operations
  // =============================================================================

  // CreateProjectUser creates a new user within a project.
  //
  // Creates a project-level user (single-tenant mode). The pistachio_id is
  // system-generated and returned in the response.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or user field format
  // - ALREADY_EXISTS: Email or phone number already in use within the project
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc CreateProjectUser(CreateProjectUserRequest) returns (CreateProjectUserResponse);

  // GetProjectUser retrieves a project-level user by pistachio_id.
  //
  // Returns the user's profile data including email, phone, display name,
  // and custom claims.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or pistachio_id format
  // - NOT_FOUND: Project or user does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetProjectUser(GetProjectUserRequest) returns (GetProjectUserResponse);

  // UpdateProjectUser updates an existing project-level user.
  //
  // Updates the user's profile fields. Only provided fields are updated;
  // omitted fields retain their current values.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, pistachio_id, or field format
  // - ALREADY_EXISTS: Email or phone number already in use by another user
  // - NOT_FOUND: Project or user does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UpdateProjectUser(UpdateProjectUserRequest) returns (UpdateProjectUserResponse);

  // DeleteProjectUser permanently deletes a project-level user.
  //
  // This operation is irreversible. All user data and authentication
  // credentials will be permanently deleted.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or pistachio_id format
  // - NOT_FOUND: Project or user does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteProjectUser(DeleteProjectUserRequest) returns (DeleteProjectUserResponse);

  // ListProjectUsers lists all users within a project.
  //
  // Results are paginated and sorted by creation time by default.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, page_size, or page_token
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListProjectUsers(ListProjectUsersRequest) returns (ListProjectUsersResponse);

  // ImportProjectUsers batch imports users into a project.
  //
  // Allows bulk import of users from external systems with optional
  // password hash migration. Supports scrypt, bcrypt, argon2, and PBKDF2.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, user records, or hash config
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ImportProjectUsers(ImportProjectUsersRequest) returns (ImportProjectUsersResponse);

  // SearchProjectUsers searches for users within a project.
  //
  // Provides advanced search capabilities including:
  // - Full-text search across user fields
  // - Field-specific queries (e.g., email:*@example.com, disabled:true)
  // - Boolean operators (AND, OR, NOT)
  // - Range queries for dates
  // - Flexible sorting and cursor-based pagination
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or search query
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc SearchProjectUsers(SearchProjectUsersRequest) returns (SearchProjectUsersResponse);

  // =============================================================================
  // Tenant User Operations
  // =============================================================================

  // CreateTenantUser creates a new user within a tenant.
  //
  // Creates a tenant-level user (multi-tenant mode). The pistachio_id is
  // system-generated and returned in the response.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, or user field format
  // - ALREADY_EXISTS: Email or phone number already in use within the tenant
  // - NOT_FOUND: Project or tenant does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc CreateTenantUser(CreateTenantUserRequest) returns (CreateTenantUserResponse);

  // GetTenantUser retrieves a tenant-level user by pistachio_id.
  //
  // Returns the user's profile data including email, phone, display name,
  // and custom claims.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, or pistachio_id format
  // - NOT_FOUND: Project, tenant, or user does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetTenantUser(GetTenantUserRequest) returns (GetTenantUserResponse);

  // UpdateTenantUser updates an existing tenant-level user.
  //
  // Updates the user's profile fields. Only provided fields are updated;
  // omitted fields retain their current values.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, pistachio_id, or field format
  // - ALREADY_EXISTS: Email or phone number already in use by another user
  // - NOT_FOUND: Project, tenant, or user does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UpdateTenantUser(UpdateTenantUserRequest) returns (UpdateTenantUserResponse);

  // DeleteTenantUser permanently deletes a tenant-level user.
  //
  // This operation is irreversible. All user data and authentication
  // credentials will be permanently deleted.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, or pistachio_id format
  // - NOT_FOUND: Project, tenant, or user does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteTenantUser(DeleteTenantUserRequest) returns (DeleteTenantUserResponse);

  // ListTenantUsers lists all users within a tenant.
  //
  // Results are paginated and sorted by creation time by default.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, page_size, or page_token
  // - NOT_FOUND: Project or tenant does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListTenantUsers(ListTenantUsersRequest) returns (ListTenantUsersResponse);

  // ImportTenantUsers batch imports users into a tenant.
  //
  // Allows bulk import of users from external systems with optional
  // password hash migration. Supports scrypt, bcrypt, argon2, and PBKDF2.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, user records, or hash config
  // - NOT_FOUND: Project or tenant does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ImportTenantUsers(ImportTenantUsersRequest) returns (ImportTenantUsersResponse);

  // SearchTenantUsers searches for users within a tenant.
  //
  // Provides advanced search capabilities including:
  // - Full-text search across user fields
  // - Field-specific queries (e.g., email:*@example.com, disabled:true)
  // - Boolean operators (AND, OR, NOT)
  // - Range queries for dates
  // - Flexible sorting and cursor-based pagination
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, or search query
  // - NOT_FOUND: Project or tenant does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc SearchTenantUsers(SearchTenantUsersRequest) returns (SearchTenantUsersResponse);

  // =============================================================================
  // Service Account Operations
  // =============================================================================

  // CreateServiceAccount creates a new service account within a project.
  //
  // Service accounts are used for server-to-server authentication using
  // cryptographic keys instead of passwords.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, service_account_id, or display_name format
  // - ALREADY_EXISTS: Service account ID is already taken within this project
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc CreateServiceAccount(CreateServiceAccountRequest) returns (CreateServiceAccountResponse);

  // GetServiceAccount retrieves a service account by its ID.
  //
  // Returns the service account details including email and disabled status.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or service_account_id format
  // - NOT_FOUND: Project or service account does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetServiceAccount(GetServiceAccountRequest) returns (GetServiceAccountResponse);

  // UpdateServiceAccount updates an existing service account.
  //
  // Updates the display name, description, or disabled status.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, service_account_id, or field format
  // - NOT_FOUND: Project or service account does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UpdateServiceAccount(UpdateServiceAccountRequest) returns (UpdateServiceAccountResponse);

  // DeleteServiceAccount permanently deletes a service account.
  //
  // This operation is irreversible. All keys associated with the service
  // account will also be deleted.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or service_account_id format
  // - NOT_FOUND: Project or service account does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteServiceAccount(DeleteServiceAccountRequest) returns (DeleteServiceAccountResponse);

  // ListServiceAccounts lists all service accounts within a project.
  //
  // Results are paginated and sorted by creation time by default.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, page_size, or page_token
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListServiceAccounts(ListServiceAccountsRequest) returns (ListServiceAccountsResponse);

  // SearchServiceAccounts searches for service accounts within a project.
  //
  // Provides advanced search capabilities including full-text search,
  // field-specific queries, and flexible sorting.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or search query
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc SearchServiceAccounts(SearchServiceAccountsRequest) returns (SearchServiceAccountsResponse);

  // GenerateServiceAccountKey generates a new key for a service account.
  //
  // The private key data is only returned once in the response.
  // Store it securely as it cannot be retrieved again.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, service_account_id, or key_algorithm
  // - NOT_FOUND: Project or service account does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GenerateServiceAccountKey(GenerateServiceAccountKeyRequest) returns (GenerateServiceAccountKeyResponse);

  // ListServiceAccountKeys lists all keys for a service account.
  //
  // Returns key metadata only; private key data is never returned after creation.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or service_account_id format
  // - NOT_FOUND: Project or service account does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListServiceAccountKeys(ListServiceAccountKeysRequest) returns (ListServiceAccountKeysResponse);

  // GetServiceAccountKey retrieves a specific key by ID.
  //
  // Returns key metadata only; private key data is never returned after creation.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, service_account_id, or key_id format
  // - NOT_FOUND: Project, service account, or key does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetServiceAccountKey(GetServiceAccountKeyRequest) returns (GetServiceAccountKeyResponse);

  // DeleteServiceAccountKey permanently deletes a key.
  //
  // This operation is irreversible. Applications using this key will
  // no longer be able to authenticate.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, service_account_id, or key_id format
  // - NOT_FOUND: Project, service account, or key does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteServiceAccountKey(DeleteServiceAccountKeyRequest) returns (DeleteServiceAccountKeyResponse);

  // DisableServiceAccountKey disables a key without deleting it.
  //
  // Disabled keys cannot be used for authentication but can be re-enabled.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, service_account_id, or key_id format
  // - NOT_FOUND: Project, service account, or key does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DisableServiceAccountKey(DisableServiceAccountKeyRequest) returns (DisableServiceAccountKeyResponse);

  // EnableServiceAccountKey re-enables a disabled key.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, service_account_id, or key_id format
  // - NOT_FOUND: Project, service account, or key does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc EnableServiceAccountKey(EnableServiceAccountKeyRequest) returns (EnableServiceAccountKeyResponse);

  // =============================================================================
  // API Key Operations
  // =============================================================================

  // CreateApiKey creates a new API key for an app.
  //
  // The full key string is only returned in this response.
  // Store it securely as it cannot be retrieved again.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, app_id, or restrictions format
  // - NOT_FOUND: Project or app does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc CreateApiKey(CreateApiKeyRequest) returns (CreateApiKeyResponse);

  // GetApiKey retrieves an API key by ID.
  //
  // Returns key metadata with masked key prefix only.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, app_id, or key_id format
  // - NOT_FOUND: Project, app, or key does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetApiKey(GetApiKeyRequest) returns (GetApiKeyResponse);

  // UpdateApiKey updates an existing API key.
  //
  // Updates the display name or restrictions.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, app_id, key_id, or field format
  // - NOT_FOUND: Project, app, or key does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UpdateApiKey(UpdateApiKeyRequest) returns (UpdateApiKeyResponse);

  // DeleteApiKey permanently deletes an API key.
  //
  // This operation is irreversible. Applications using this key will
  // no longer be able to authenticate.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, app_id, or key_id format
  // - NOT_FOUND: Project, app, or key does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteApiKey(DeleteApiKeyRequest) returns (DeleteApiKeyResponse);

  // ListApiKeys lists all API keys for an app.
  //
  // Returns key metadata with masked key prefixes only.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, app_id, page_size, or page_token
  // - NOT_FOUND: Project or app does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListApiKeys(ListApiKeysRequest) returns (ListApiKeysResponse);

  // RotateApiKey generates a new key string for an existing API key.
  //
  // The previous key string remains valid for a grace period (typically 24 hours)
  // to allow for key rotation without downtime.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, app_id, or key_id format
  // - NOT_FOUND: Project, app, or key does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc RotateApiKey(RotateApiKeyRequest) returns (RotateApiKeyResponse);

  // =============================================================================
  // User MFA Administration
  // =============================================================================

  // ListProjectUserMfaFactors lists MFA factors for a project-level user.
  //
  // Allows administrators to view a user's enrolled MFA factors.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or pistachio_id format
  // - NOT_FOUND: Project or user does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListProjectUserMfaFactors(ListProjectUserMfaFactorsRequest) returns (ListProjectUserMfaFactorsResponse);

  // DeleteProjectUserMfaFactor removes an MFA factor from a project-level user.
  //
  // Allows administrators to remove a user's MFA factor, for example when
  // a user loses access to their authenticator device.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, pistachio_id, or factor_id format
  // - NOT_FOUND: Project, user, or factor does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteProjectUserMfaFactor(DeleteProjectUserMfaFactorRequest) returns (DeleteProjectUserMfaFactorResponse);

  // ListTenantUserMfaFactors lists MFA factors for a tenant-level user.
  //
  // Allows administrators to view a user's enrolled MFA factors.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, or pistachio_id format
  // - NOT_FOUND: Project, tenant, or user does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListTenantUserMfaFactors(ListTenantUserMfaFactorsRequest) returns (ListTenantUserMfaFactorsResponse);

  // DeleteTenantUserMfaFactor removes an MFA factor from a tenant-level user.
  //
  // Allows administrators to remove a user's MFA factor, for example when
  // a user loses access to their authenticator device.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, tenant_id, pistachio_id, or factor_id format
  // - NOT_FOUND: Project, tenant, user, or factor does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteTenantUserMfaFactor(DeleteTenantUserMfaFactorRequest) returns (DeleteTenantUserMfaFactorResponse);

  // =============================================================================
  // Token Operations
  // =============================================================================

  // CreateCustomToken creates a custom token for server-side authentication.
  //
  // Custom tokens allow server-side authentication of users when integrating
  // with external identity systems. The token can be exchanged for an ID token.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, pistachio_id, or claims format
  // - NOT_FOUND: Project or user does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc CreateCustomToken(CreateCustomTokenRequest) returns (CreateCustomTokenResponse);

  // VerifyIdToken verifies an ID token and returns its claims.
  //
  // Validates the token signature, expiration, and optionally checks
  // if the token has been revoked.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or id_token format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc VerifyIdToken(VerifyIdTokenRequest) returns (VerifyIdTokenResponse);

  // CreateSessionCookie creates a session cookie from an ID token.
  //
  // Session cookies provide long-lived authentication for web applications
  // and should be set as HTTP-only, secure cookies.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id, id_token, or expires_in format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc CreateSessionCookie(CreateSessionCookieRequest) returns (CreateSessionCookieResponse);

  // VerifySessionCookie verifies a session cookie and returns its claims.
  //
  // Validates the cookie signature, expiration, and optionally checks
  // if the session has been revoked.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or session_cookie format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc VerifySessionCookie(VerifySessionCookieRequest) returns (VerifySessionCookieResponse);

  // RevokeRefreshTokens revokes all refresh tokens for a user.
  //
  // This invalidates all existing sessions for the user, forcing them
  // to re-authenticate on their next request.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or pistachio_id format
  // - NOT_FOUND: Project or user does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc RevokeRefreshTokens(RevokeRefreshTokensRequest) returns (RevokeRefreshTokensResponse);

  // =============================================================================
  // Usage and Quotas
  // =============================================================================

  // GetProjectUsage retrieves usage statistics for a project.
  //
  // Returns metrics including active users, authentication events,
  // API calls, and storage usage for the specified time period.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or time range format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetProjectUsage(GetProjectUsageRequest) returns (GetProjectUsageResponse);

  // GetProjectQuotas retrieves quota limits for a project.
  //
  // Returns the configured limits and current usage for users,
  // service accounts, tenants, apps, and rate limits.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetProjectQuotas(GetProjectQuotasRequest) returns (GetProjectQuotasResponse);

  // UpdateProjectQuotas updates quota limits for a project.
  //
  // Only provided fields are updated. Use -1 to indicate unlimited.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or quota values
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UpdateProjectQuotas(UpdateProjectQuotasRequest) returns (UpdateProjectQuotasResponse);
}
