syntax = "proto3";

package pistachio.admin.v1;

import "pistachio/admin/v1/project.proto";

// =============================================================================
// Project Management Service
// =============================================================================
// ProjectManagement provides administrative operations for managing Pistachio projects.
// Requires service account authentication.
service ProjectManagement {
  // CreateProject creates a new Pistachio project.
  //
  // Projects are the top-level container for apps, users, and resources.
  // Each project can have multiple apps across different platforms
  // that share the same user pool.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id format or display_name
  // - ALREADY_EXISTS: Project ID is already taken
  // - PERMISSION_DENIED: Insufficient permissions
  rpc CreateProject(CreateProjectRequest) returns (CreateProjectResponse);

  // GetProject retrieves a project by its ID.
  //
  // Returns the project details including its current state and resources.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetProject(GetProjectRequest) returns (GetProjectResponse);

  // UpdateProject updates an existing project.
  //
  // Currently only the display_name can be updated.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id or display_name format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UpdateProject(UpdateProjectRequest) returns (UpdateProjectResponse);

  // DeleteProject soft-deletes a project.
  //
  // The project will be marked as DELETED and will be permanently removed
  // after 30 days. During this period, the project can be restored.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc DeleteProject(DeleteProjectRequest) returns (DeleteProjectResponse);

  // UndeleteProject restores a soft-deleted project.
  //
  // The project must be in the DELETED state and within the 30-day
  // grace period. The project will be restored to ACTIVE state.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id format
  // - NOT_FOUND: Project does not exist
  // - FAILED_PRECONDITION: Project is not in DELETED state
  // - PERMISSION_DENIED: Insufficient permissions
  rpc UndeleteProject(UndeleteProjectRequest) returns (UndeleteProjectResponse);

  // ListProjects lists all projects accessible to the service account.
  //
  // Results are paginated and can optionally include deleted projects.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid page_size or page_token
  // - PERMISSION_DENIED: Insufficient permissions
  rpc ListProjects(ListProjectsRequest) returns (ListProjectsResponse);

  // SearchProjects searches for projects using full-text search.
  //
  // Provides advanced search capabilities including:
  // - Full-text search across project fields
  // - Field-specific queries (e.g., display_name:Production*)
  // - Boolean operators (AND, OR, NOT)
  // - Range queries for dates
  // - Flexible sorting and cursor-based pagination
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid search query or parameters
  // - PERMISSION_DENIED: Insufficient permissions
  rpc SearchProjects(SearchProjectsRequest) returns (SearchProjectsResponse);

  // GetAdminSdkConfig retrieves the Admin SDK configuration for a project.
  //
  // Returns configuration needed to initialize the Admin SDK, including
  // storage bucket URL and database URL.
  //
  // Errors:
  // - INVALID_ARGUMENT: Invalid project_id format
  // - NOT_FOUND: Project does not exist
  // - PERMISSION_DENIED: Insufficient permissions
  rpc GetAdminSdkConfig(GetAdminSdkConfigRequest) returns (GetAdminSdkConfigResponse);
}
