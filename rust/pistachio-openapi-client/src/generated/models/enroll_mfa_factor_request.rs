/*
 * Pistachio API
 *
 * API for end-to-end encrypted applications.
 *
 * The version of the OpenAPI document: 0.1.0
 *
 * Generated by: https://openapi-generator.tech
 */

use crate::generated::models;
use serde::{Deserialize, Serialize};

/// EnrollMfaFactorRequest : Request body for enrolling an MFA factor.
#[derive(Clone, Default, Debug, PartialEq, Serialize, Deserialize)]
pub struct EnrollMfaFactorRequest {
    /// The type of factor to enroll.
    #[serde(rename = "factorType")]
    pub factor_type: FactorType,
    /// User-provided name for the factor.
    #[serde(rename = "displayName", skip_serializing_if = "Option::is_none")]
    pub display_name: Option<String>,
    /// Phone number for SMS factor (E.164 format).
    #[serde(rename = "phoneNumber", skip_serializing_if = "Option::is_none")]
    pub phone_number: Option<String>,
}

impl EnrollMfaFactorRequest {
    /// Request body for enrolling an MFA factor.
    pub fn new(factor_type: FactorType) -> EnrollMfaFactorRequest {
        EnrollMfaFactorRequest {
            factor_type,
            display_name: None,
            phone_number: None,
        }
    }
}
/// The type of factor to enroll.
#[derive(Clone, Copy, Debug, Eq, PartialEq, Ord, PartialOrd, Hash, Serialize, Deserialize)]
pub enum FactorType {
    #[serde(rename = "TOTP")]
    Totp,
    #[serde(rename = "SMS")]
    Sms,
    #[serde(rename = "EMAIL")]
    Email,
}

impl Default for FactorType {
    fn default() -> FactorType {
        Self::Totp
    }
}
