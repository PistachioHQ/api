openapi: 3.1.0
info:
  title: Pistachio API
  description: |
    API for end-to-end encrypted applications.
  version: 0.1.0
  contact:
    name: Pistachio Team

servers:
  - url: https://api.pistachiohq.com/v1
    description: Production server
  - url: https://api.staging.pistachiohq.com/v1
    description: Staging server

tags:
  - name: Health
    description: Service health checks
  - name: Auth
    description: Authentication validation endpoints

paths:
  /health:
    $ref: './paths/health.yml#/health'
  /auth/validate-key:
    $ref: './paths/auth.yml#/validate-key'
  /auth/validate-token:
    $ref: './paths/auth.yml#/validate-token'
  /auth/validate-service-account:
    $ref: './paths/auth.yml#/validate-service-account'

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: query
      name: key
      description: API key for client SDK operations. API keys are auto-generated per app and identify the project.
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: ID token (JWT) for authenticated operations. Obtained via sign-in and must be included in the Authorization header.
    ServiceAccountAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Service account credential for admin operations.
